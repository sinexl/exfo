extern "C" func puts(char_ptr): void;

func side_true(): bool {
    puts("side_true executed");
    return true;
}

func main(): int {

    puts("------------");
    puts("Basic cases: expect: then 2, else 3, outer, if.else.if 4.1.1");

    if false puts("then 1");
    if true  puts("then 2");

    if false {
        puts("then 3");
    } else {
        puts("else 3");
    }

    puts("outer");

    if true {
        if false puts("then 4.1");
        else if true puts("if.else.if 4.1.1");
        else puts("else 4.1");
    }
    else puts("else 4");

    puts("------------");
    puts("statement capture. Expect: B");
    if false
        puts("A");
        puts("B");

    puts("------------");
    puts("statement capture 2. Expect: A B");

    if true
        puts("A");
        puts("B");

    puts("------------");
    puts("nested no braces & outer else: expect H3");

    if false
        if true
            puts("H1");
        else
            puts("H2");
    else
        puts("H3");

    puts("------------");
    puts("triple nesting: expect: I2");
    if true
        if true
            if false
                puts("I1");
            else
                puts("I2");

    puts("------------");
    puts("dangling else test (expect: inner-else)");

    if true
        if false
            puts("inner-then");
        else
            puts("inner-else");

    puts("------------");
    puts("empty branch test (expect: after empty)");

    if true {
    } else {
        puts("should not see this");
    }

    puts("after empty");
    puts("------------");

    puts("else-if chain (expect: branch 3)");
    n := 3;
    if n == 1 puts("branch 1");
    else if n == 2 {
        puts("branch 2");
    }
    else if n == 3
        puts("branch 3");
    else {
        puts("default");
    }

    puts("------------");
    puts("inside loop: expect zero, one, two");

    i := 0;
    while i < 3 {
        if i == 0 puts("zero");
        else if i == 1 puts("one");
        else puts("two");

        i = i + 1;
    }

    puts("------------");
    puts("short circuit in condition (basic) (expect: short-circuit works, side-true executed, short-circuit works)");

    if true || side_true() {
        puts("short-circuit works");
    }
    if false || side_true() {
        puts("short-circuit works");
    }

    return 0;
}
